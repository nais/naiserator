// generated by your friendly code generator. DO NOT EDIT.
// to refresh this file, run `go generate` in your shell.

package updater

import (
	"fmt"

	iam_cnrm_cloud_google_com_v1beta1 "github.com/nais/naiserator/pkg/apis/iam.cnrm.cloud.google.com/v1beta1"
	nais "github.com/nais/naiserator/pkg/apis/nais.io/v1alpha1"
	networking_istio_io_v1alpha3 "github.com/nais/naiserator/pkg/apis/networking.istio.io/v1alpha3"
	sql_cnrm_cloud_google_com_v1beta1 "github.com/nais/naiserator/pkg/apis/sql.cnrm.cloud.google.com/v1beta1"
	storage_cnrm_cloud_google_com_v1beta1 "github.com/nais/naiserator/pkg/apis/storage.cnrm.cloud.google.com/v1beta1"
	clientV1Alpha1 "github.com/nais/naiserator/pkg/client/clientset/versioned"
	typed_iam_cnrm_cloud_google_com_v1beta1 "github.com/nais/naiserator/pkg/client/clientset/versioned/typed/iam.cnrm.cloud.google.com/v1beta1"
	typed_networking_istio_io_v1alpha3 "github.com/nais/naiserator/pkg/client/clientset/versioned/typed/networking.istio.io/v1alpha3"
	typed_sql_cnrm_cloud_google_com_v1beta1 "github.com/nais/naiserator/pkg/client/clientset/versioned/typed/sql.cnrm.cloud.google.com/v1beta1"
	typed_storage_cnrm_cloud_google_com_v1beta1 "github.com/nais/naiserator/pkg/client/clientset/versioned/typed/storage.cnrm.cloud.google.com/v1beta1"
	log "github.com/sirupsen/logrus"
	istio_security_v1beta1 "istio.io/client-go/pkg/apis/security/v1beta1"
	istioClientSet "istio.io/client-go/pkg/clientset/versioned"
	typed_istio_security_v1beta1 "istio.io/client-go/pkg/clientset/versioned/typed/security/v1beta1"
	appsv1 "k8s.io/api/apps/v1"
	autoscalingv1 "k8s.io/api/autoscaling/v1"
	corev1 "k8s.io/api/core/v1"
	networkingv1 "k8s.io/api/networking/v1"
	networkingv1beta1 "k8s.io/api/networking/v1beta1"
	rbacv1 "k8s.io/api/rbac/v1"
	"k8s.io/apimachinery/pkg/api/errors"
	"k8s.io/apimachinery/pkg/api/meta"
	metav1 "k8s.io/apimachinery/pkg/apis/meta/v1"
	"k8s.io/apimachinery/pkg/runtime"
	"k8s.io/client-go/kubernetes"
	typed_apps_v1 "k8s.io/client-go/kubernetes/typed/apps/v1"
	typed_autoscaling_v1 "k8s.io/client-go/kubernetes/typed/autoscaling/v1"
	typed_core_v1 "k8s.io/client-go/kubernetes/typed/core/v1"
	typed_networking_v1 "k8s.io/client-go/kubernetes/typed/networking/v1"
	typed_networking_v1beta1 "k8s.io/client-go/kubernetes/typed/networking/v1beta1"
	typed_rbac_v1 "k8s.io/client-go/kubernetes/typed/rbac/v1"
)

func service(client typed_core_v1.ServiceInterface, old, new *corev1.Service) func() error {
	log.Infof("creating or updating *corev1.Service for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "service", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	CopyService(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "service", err)
		}
		return err
	}
}

func secret(client typed_core_v1.SecretInterface, old, new *corev1.Secret) func() error {
	log.Infof("creating or updating *corev1.Secret for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "secret", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "secret", err)
		}
		return err
	}
}

func serviceAccount(client typed_core_v1.ServiceAccountInterface, old, new *corev1.ServiceAccount) func() error {
	log.Infof("creating or updating *corev1.ServiceAccount for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "serviceAccount", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "serviceAccount", err)
		}
		return err
	}
}

func deployment(client typed_apps_v1.DeploymentInterface, old, new *appsv1.Deployment) func() error {
	log.Infof("creating or updating *appsv1.Deployment for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "deployment", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "deployment", err)
		}
		return err
	}
}

func ingress(client typed_networking_v1beta1.IngressInterface, old, new *networkingv1beta1.Ingress) func() error {
	log.Infof("creating or updating *networkingv1beta1.Ingress for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "ingress", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "ingress", err)
		}
		return err
	}
}

func horizontalPodAutoscaler(client typed_autoscaling_v1.HorizontalPodAutoscalerInterface, old, new *autoscalingv1.HorizontalPodAutoscaler) func() error {
	log.Infof("creating or updating *autoscalingv1.HorizontalPodAutoscaler for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "horizontalPodAutoscaler", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "horizontalPodAutoscaler", err)
		}
		return err
	}
}

func networkPolicy(client typed_networking_v1.NetworkPolicyInterface, old, new *networkingv1.NetworkPolicy) func() error {
	log.Infof("creating or updating *networkingv1.NetworkPolicy for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "networkPolicy", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "networkPolicy", err)
		}
		return err
	}
}

func virtualService(client typed_networking_istio_io_v1alpha3.VirtualServiceInterface, old, new *networking_istio_io_v1alpha3.VirtualService) func() error {
	log.Infof("creating or updating *networking_istio_io_v1alpha3.VirtualService for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "virtualService", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "virtualService", err)
		}
		return err
	}
}

func ServiceEntry(client typed_networking_istio_io_v1alpha3.ServiceEntryInterface, old, new *networking_istio_io_v1alpha3.ServiceEntry) func() error {
	log.Infof("creating or updating *networking_istio_io_v1alpha3.ServiceEntry for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "ServiceEntry", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "ServiceEntry", err)
		}
		return err
	}
}

func Role(client typed_rbac_v1.RoleInterface, old, new *rbacv1.Role) func() error {
	log.Infof("creating or updating *rbacv1.Role for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "Role", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "Role", err)
		}
		return err
	}
}

func RoleBinding(client typed_rbac_v1.RoleBindingInterface, old, new *rbacv1.RoleBinding) func() error {
	log.Infof("creating or updating *rbacv1.RoleBinding for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "RoleBinding", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "RoleBinding", err)
		}
		return err
	}
}

func iamServiceAccount(client typed_iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccountInterface, old, new *iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount) func() error {
	log.Infof("creating or updating *iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "iamServiceAccount", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "iamServiceAccount", err)
		}
		return err
	}
}

func iamPolicy(client typed_iam_cnrm_cloud_google_com_v1beta1.IAMPolicyInterface, old, new *iam_cnrm_cloud_google_com_v1beta1.IAMPolicy) func() error {
	log.Infof("creating or updating *iam_cnrm_cloud_google_com_v1beta1.IAMPolicy for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "iamPolicy", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "iamPolicy", err)
		}
		return err
	}
}

func iamPolicyMember(client typed_iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMemberInterface, old, new *iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember) func() error {
	log.Infof("creating or updating *iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "iamPolicyMember", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "iamPolicyMember", err)
		}
		return err
	}
}

func googleStorageBucket(client typed_storage_cnrm_cloud_google_com_v1beta1.StorageBucketInterface, old, new *storage_cnrm_cloud_google_com_v1beta1.StorageBucket) func() error {
	log.Infof("creating or updating *storage_cnrm_cloud_google_com_v1beta1.StorageBucket for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "googleStorageBucket", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "googleStorageBucket", err)
		}
		return err
	}
}

func googleStorageBucketAccessControl(client typed_storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControlInterface, old, new *storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl) func() error {
	log.Infof("creating or updating *storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "googleStorageBucketAccessControl", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "googleStorageBucketAccessControl", err)
		}
		return err
	}
}

func sqlInstance(client typed_sql_cnrm_cloud_google_com_v1beta1.SQLInstanceInterface, old, new *sql_cnrm_cloud_google_com_v1beta1.SQLInstance) func() error {
	log.Infof("creating or updating *sql_cnrm_cloud_google_com_v1beta1.SQLInstance for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "sqlInstance", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "sqlInstance", err)
		}
		return err
	}
}

func sqlDatabase(client typed_sql_cnrm_cloud_google_com_v1beta1.SQLDatabaseInterface, old, new *sql_cnrm_cloud_google_com_v1beta1.SQLDatabase) func() error {
	log.Infof("creating or updating *sql_cnrm_cloud_google_com_v1beta1.SQLDatabase for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "sqlDatabase", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "sqlDatabase", err)
		}
		return err
	}
}

func sqlUser(client typed_sql_cnrm_cloud_google_com_v1beta1.SQLUserInterface, old, new *sql_cnrm_cloud_google_com_v1beta1.SQLUser) func() error {
	log.Infof("creating or updating *sql_cnrm_cloud_google_com_v1beta1.SQLUser for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "sqlUser", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "sqlUser", err)
		}
		return err
	}
}

func authorizationPolicy(client typed_istio_security_v1beta1.AuthorizationPolicyInterface, old, new *istio_security_v1beta1.AuthorizationPolicy) func() error {
	log.Infof("creating or updating *istio_security_v1beta1.AuthorizationPolicy for %s", new.Name)
	if old == nil {
		return func() error {
			_, err := client.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "authorizationPolicy", err)
			}
			return err
		}
	}

	CopyMeta(old, new)

	return func() error {
		_, err := client.Update(new)
		if err != nil {
			return fmt.Errorf("%s: %s", "authorizationPolicy", err)
		}
		return err
	}
}

func CreateOrUpdate(clientSet kubernetes.Interface, customClient clientV1Alpha1.Interface, istioClient istioClientSet.Interface, resource runtime.Object) func() error {
	switch new := resource.(type) {

	case *corev1.Service:
		c := clientSet.CoreV1().Services(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "service", err) }
			}
			return service(c, nil, new)
		}
		return service(c, old, new)

	case *corev1.Secret:
		c := clientSet.CoreV1().Secrets(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "secret", err) }
			}
			return secret(c, nil, new)
		}
		return secret(c, old, new)

	case *corev1.ServiceAccount:
		c := clientSet.CoreV1().ServiceAccounts(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "serviceAccount", err) }
			}
			return serviceAccount(c, nil, new)
		}
		return serviceAccount(c, old, new)

	case *appsv1.Deployment:
		c := clientSet.AppsV1().Deployments(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "deployment", err) }
			}
			return deployment(c, nil, new)
		}
		return deployment(c, old, new)

	case *networkingv1beta1.Ingress:
		c := clientSet.NetworkingV1beta1().Ingresses(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "ingress", err) }
			}
			return ingress(c, nil, new)
		}
		return ingress(c, old, new)

	case *autoscalingv1.HorizontalPodAutoscaler:
		c := clientSet.AutoscalingV1().HorizontalPodAutoscalers(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "horizontalPodAutoscaler", err) }
			}
			return horizontalPodAutoscaler(c, nil, new)
		}
		return horizontalPodAutoscaler(c, old, new)

	case *networkingv1.NetworkPolicy:
		c := clientSet.NetworkingV1().NetworkPolicies(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "networkPolicy", err) }
			}
			return networkPolicy(c, nil, new)
		}
		return networkPolicy(c, old, new)

	case *networking_istio_io_v1alpha3.VirtualService:
		c := customClient.NetworkingV1alpha3().VirtualServices(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "virtualService", err) }
			}
			return virtualService(c, nil, new)
		}
		return virtualService(c, old, new)

	case *networking_istio_io_v1alpha3.ServiceEntry:
		c := customClient.NetworkingV1alpha3().ServiceEntries(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "ServiceEntry", err) }
			}
			return ServiceEntry(c, nil, new)
		}
		return ServiceEntry(c, old, new)

	case *rbacv1.Role:
		c := clientSet.RbacV1().Roles(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "Role", err) }
			}
			return Role(c, nil, new)
		}
		return Role(c, old, new)

	case *rbacv1.RoleBinding:
		c := clientSet.RbacV1().RoleBindings(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "RoleBinding", err) }
			}
			return RoleBinding(c, nil, new)
		}
		return RoleBinding(c, old, new)

	case *iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount:
		c := customClient.IamV1beta1().IAMServiceAccounts(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "iamServiceAccount", err) }
			}
			return iamServiceAccount(c, nil, new)
		}
		return iamServiceAccount(c, old, new)

	case *iam_cnrm_cloud_google_com_v1beta1.IAMPolicy:
		c := customClient.IamV1beta1().IAMPolicies(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "iamPolicy", err) }
			}
			return iamPolicy(c, nil, new)
		}
		return iamPolicy(c, old, new)

	case *iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember:
		c := customClient.IamV1beta1().IAMPolicyMembers(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "iamPolicyMember", err) }
			}
			return iamPolicyMember(c, nil, new)
		}
		return iamPolicyMember(c, old, new)

	case *storage_cnrm_cloud_google_com_v1beta1.StorageBucket:
		c := customClient.StorageV1beta1().StorageBuckets(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "googleStorageBucket", err) }
			}
			return googleStorageBucket(c, nil, new)
		}
		return googleStorageBucket(c, old, new)

	case *storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl:
		c := customClient.StorageV1beta1().StorageBucketAccessControls(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "googleStorageBucketAccessControl", err) }
			}
			return googleStorageBucketAccessControl(c, nil, new)
		}
		return googleStorageBucketAccessControl(c, old, new)

	case *sql_cnrm_cloud_google_com_v1beta1.SQLInstance:
		c := customClient.SqlV1beta1().SQLInstances(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "sqlInstance", err) }
			}
			return sqlInstance(c, nil, new)
		}
		return sqlInstance(c, old, new)

	case *sql_cnrm_cloud_google_com_v1beta1.SQLDatabase:
		c := customClient.SqlV1beta1().SQLDatabases(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "sqlDatabase", err) }
			}
			return sqlDatabase(c, nil, new)
		}
		return sqlDatabase(c, old, new)

	case *sql_cnrm_cloud_google_com_v1beta1.SQLUser:
		c := customClient.SqlV1beta1().SQLUsers(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "sqlUser", err) }
			}
			return sqlUser(c, nil, new)
		}
		return sqlUser(c, old, new)

	case *istio_security_v1beta1.AuthorizationPolicy:
		c := istioClient.SecurityV1beta1().AuthorizationPolicies(new.Namespace)
		old, err := c.Get(new.Name, metav1.GetOptions{})
		if err != nil {
			if !errors.IsNotFound(err) {
				return func() error { return fmt.Errorf("%s: %s", "authorizationPolicy", err) }
			}
			return authorizationPolicy(c, nil, new)
		}
		return authorizationPolicy(c, old, new)

	default:
		panic(fmt.Errorf("BUG! You didn't specify a case for type '%T' in the file hack/generator/updater.go", new))
	}
}

func CreateOrRecreate(clientSet kubernetes.Interface, customClient clientV1Alpha1.Interface, istioClient istioClientSet.Interface, resource runtime.Object) func() error {
	switch new := resource.(type) {

	case *corev1.Service:
		c := clientSet.CoreV1().Services(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *corev1.Service for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "service", err)
			}
			log.Infof("creating new *corev1.Service for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "service", err)
			} else {
				return nil
			}
		}

	case *corev1.Secret:
		c := clientSet.CoreV1().Secrets(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *corev1.Secret for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "secret", err)
			}
			log.Infof("creating new *corev1.Secret for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "secret", err)
			} else {
				return nil
			}
		}

	case *corev1.ServiceAccount:
		c := clientSet.CoreV1().ServiceAccounts(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *corev1.ServiceAccount for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "serviceAccount", err)
			}
			log.Infof("creating new *corev1.ServiceAccount for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "serviceAccount", err)
			} else {
				return nil
			}
		}

	case *appsv1.Deployment:
		c := clientSet.AppsV1().Deployments(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *appsv1.Deployment for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "deployment", err)
			}
			log.Infof("creating new *appsv1.Deployment for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "deployment", err)
			} else {
				return nil
			}
		}

	case *networkingv1beta1.Ingress:
		c := clientSet.NetworkingV1beta1().Ingresses(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *networkingv1beta1.Ingress for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "ingress", err)
			}
			log.Infof("creating new *networkingv1beta1.Ingress for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "ingress", err)
			} else {
				return nil
			}
		}

	case *autoscalingv1.HorizontalPodAutoscaler:
		c := clientSet.AutoscalingV1().HorizontalPodAutoscalers(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *autoscalingv1.HorizontalPodAutoscaler for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "horizontalPodAutoscaler", err)
			}
			log.Infof("creating new *autoscalingv1.HorizontalPodAutoscaler for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "horizontalPodAutoscaler", err)
			} else {
				return nil
			}
		}

	case *networkingv1.NetworkPolicy:
		c := clientSet.NetworkingV1().NetworkPolicies(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *networkingv1.NetworkPolicy for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "networkPolicy", err)
			}
			log.Infof("creating new *networkingv1.NetworkPolicy for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "networkPolicy", err)
			} else {
				return nil
			}
		}

	case *networking_istio_io_v1alpha3.VirtualService:
		c := customClient.NetworkingV1alpha3().VirtualServices(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *networking_istio_io_v1alpha3.VirtualService for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "virtualService", err)
			}
			log.Infof("creating new *networking_istio_io_v1alpha3.VirtualService for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "virtualService", err)
			} else {
				return nil
			}
		}

	case *networking_istio_io_v1alpha3.ServiceEntry:
		c := customClient.NetworkingV1alpha3().ServiceEntries(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *networking_istio_io_v1alpha3.ServiceEntry for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "ServiceEntry", err)
			}
			log.Infof("creating new *networking_istio_io_v1alpha3.ServiceEntry for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "ServiceEntry", err)
			} else {
				return nil
			}
		}

	case *rbacv1.Role:
		c := clientSet.RbacV1().Roles(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *rbacv1.Role for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "Role", err)
			}
			log.Infof("creating new *rbacv1.Role for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "Role", err)
			} else {
				return nil
			}
		}

	case *rbacv1.RoleBinding:
		c := clientSet.RbacV1().RoleBindings(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *rbacv1.RoleBinding for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "RoleBinding", err)
			}
			log.Infof("creating new *rbacv1.RoleBinding for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "RoleBinding", err)
			} else {
				return nil
			}
		}

	case *iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount:
		c := customClient.IamV1beta1().IAMServiceAccounts(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "iamServiceAccount", err)
			}
			log.Infof("creating new *iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "iamServiceAccount", err)
			} else {
				return nil
			}
		}

	case *iam_cnrm_cloud_google_com_v1beta1.IAMPolicy:
		c := customClient.IamV1beta1().IAMPolicies(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *iam_cnrm_cloud_google_com_v1beta1.IAMPolicy for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "iamPolicy", err)
			}
			log.Infof("creating new *iam_cnrm_cloud_google_com_v1beta1.IAMPolicy for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "iamPolicy", err)
			} else {
				return nil
			}
		}

	case *iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember:
		c := customClient.IamV1beta1().IAMPolicyMembers(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "iamPolicyMember", err)
			}
			log.Infof("creating new *iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "iamPolicyMember", err)
			} else {
				return nil
			}
		}

	case *storage_cnrm_cloud_google_com_v1beta1.StorageBucket:
		c := customClient.StorageV1beta1().StorageBuckets(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *storage_cnrm_cloud_google_com_v1beta1.StorageBucket for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "googleStorageBucket", err)
			}
			log.Infof("creating new *storage_cnrm_cloud_google_com_v1beta1.StorageBucket for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "googleStorageBucket", err)
			} else {
				return nil
			}
		}

	case *storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl:
		c := customClient.StorageV1beta1().StorageBucketAccessControls(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "googleStorageBucketAccessControl", err)
			}
			log.Infof("creating new *storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "googleStorageBucketAccessControl", err)
			} else {
				return nil
			}
		}

	case *sql_cnrm_cloud_google_com_v1beta1.SQLInstance:
		c := customClient.SqlV1beta1().SQLInstances(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *sql_cnrm_cloud_google_com_v1beta1.SQLInstance for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "sqlInstance", err)
			}
			log.Infof("creating new *sql_cnrm_cloud_google_com_v1beta1.SQLInstance for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "sqlInstance", err)
			} else {
				return nil
			}
		}

	case *sql_cnrm_cloud_google_com_v1beta1.SQLDatabase:
		c := customClient.SqlV1beta1().SQLDatabases(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *sql_cnrm_cloud_google_com_v1beta1.SQLDatabase for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "sqlDatabase", err)
			}
			log.Infof("creating new *sql_cnrm_cloud_google_com_v1beta1.SQLDatabase for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "sqlDatabase", err)
			} else {
				return nil
			}
		}

	case *sql_cnrm_cloud_google_com_v1beta1.SQLUser:
		c := customClient.SqlV1beta1().SQLUsers(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *sql_cnrm_cloud_google_com_v1beta1.SQLUser for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "sqlUser", err)
			}
			log.Infof("creating new *sql_cnrm_cloud_google_com_v1beta1.SQLUser for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "sqlUser", err)
			} else {
				return nil
			}
		}

	case *istio_security_v1beta1.AuthorizationPolicy:
		c := istioClient.SecurityV1beta1().AuthorizationPolicies(new.Namespace)
		return func() error {
			log.Infof("pre-deleting *istio_security_v1beta1.AuthorizationPolicy for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil && !errors.IsNotFound(err) {
				return fmt.Errorf("%s: %s", "authorizationPolicy", err)
			}
			log.Infof("creating new *istio_security_v1beta1.AuthorizationPolicy for %s", new.Name)
			_, err = c.Create(new)
			if err != nil {
				return fmt.Errorf("%s: %s", "authorizationPolicy", err)
			} else {
				return nil
			}
		}

	default:
		panic(fmt.Errorf("BUG! You didn't specify a case for type '%T' in the file hack/generator/updater.go", new))
	}
}

func CreateIfNotExists(clientSet kubernetes.Interface, customClient clientV1Alpha1.Interface, istioClient istioClientSet.Interface, resource runtime.Object) func() error {
	switch new := resource.(type) {

	case *corev1.Service:
		c := clientSet.CoreV1().Services(new.Namespace)
		return func() error {
			log.Infof("creating new *corev1.Service for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "service", err)
			}
			return nil
		}

	case *corev1.Secret:
		c := clientSet.CoreV1().Secrets(new.Namespace)
		return func() error {
			log.Infof("creating new *corev1.Secret for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "secret", err)
			}
			return nil
		}

	case *corev1.ServiceAccount:
		c := clientSet.CoreV1().ServiceAccounts(new.Namespace)
		return func() error {
			log.Infof("creating new *corev1.ServiceAccount for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "serviceAccount", err)
			}
			return nil
		}

	case *appsv1.Deployment:
		c := clientSet.AppsV1().Deployments(new.Namespace)
		return func() error {
			log.Infof("creating new *appsv1.Deployment for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "deployment", err)
			}
			return nil
		}

	case *networkingv1beta1.Ingress:
		c := clientSet.NetworkingV1beta1().Ingresses(new.Namespace)
		return func() error {
			log.Infof("creating new *networkingv1beta1.Ingress for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "ingress", err)
			}
			return nil
		}

	case *autoscalingv1.HorizontalPodAutoscaler:
		c := clientSet.AutoscalingV1().HorizontalPodAutoscalers(new.Namespace)
		return func() error {
			log.Infof("creating new *autoscalingv1.HorizontalPodAutoscaler for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "horizontalPodAutoscaler", err)
			}
			return nil
		}

	case *networkingv1.NetworkPolicy:
		c := clientSet.NetworkingV1().NetworkPolicies(new.Namespace)
		return func() error {
			log.Infof("creating new *networkingv1.NetworkPolicy for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "networkPolicy", err)
			}
			return nil
		}

	case *networking_istio_io_v1alpha3.VirtualService:
		c := customClient.NetworkingV1alpha3().VirtualServices(new.Namespace)
		return func() error {
			log.Infof("creating new *networking_istio_io_v1alpha3.VirtualService for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "virtualService", err)
			}
			return nil
		}

	case *networking_istio_io_v1alpha3.ServiceEntry:
		c := customClient.NetworkingV1alpha3().ServiceEntries(new.Namespace)
		return func() error {
			log.Infof("creating new *networking_istio_io_v1alpha3.ServiceEntry for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "ServiceEntry", err)
			}
			return nil
		}

	case *rbacv1.Role:
		c := clientSet.RbacV1().Roles(new.Namespace)
		return func() error {
			log.Infof("creating new *rbacv1.Role for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "Role", err)
			}
			return nil
		}

	case *rbacv1.RoleBinding:
		c := clientSet.RbacV1().RoleBindings(new.Namespace)
		return func() error {
			log.Infof("creating new *rbacv1.RoleBinding for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "RoleBinding", err)
			}
			return nil
		}

	case *iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount:
		c := customClient.IamV1beta1().IAMServiceAccounts(new.Namespace)
		return func() error {
			log.Infof("creating new *iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "iamServiceAccount", err)
			}
			return nil
		}

	case *iam_cnrm_cloud_google_com_v1beta1.IAMPolicy:
		c := customClient.IamV1beta1().IAMPolicies(new.Namespace)
		return func() error {
			log.Infof("creating new *iam_cnrm_cloud_google_com_v1beta1.IAMPolicy for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "iamPolicy", err)
			}
			return nil
		}

	case *iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember:
		c := customClient.IamV1beta1().IAMPolicyMembers(new.Namespace)
		return func() error {
			log.Infof("creating new *iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "iamPolicyMember", err)
			}
			return nil
		}

	case *storage_cnrm_cloud_google_com_v1beta1.StorageBucket:
		c := customClient.StorageV1beta1().StorageBuckets(new.Namespace)
		return func() error {
			log.Infof("creating new *storage_cnrm_cloud_google_com_v1beta1.StorageBucket for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "googleStorageBucket", err)
			}
			return nil
		}

	case *storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl:
		c := customClient.StorageV1beta1().StorageBucketAccessControls(new.Namespace)
		return func() error {
			log.Infof("creating new *storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "googleStorageBucketAccessControl", err)
			}
			return nil
		}

	case *sql_cnrm_cloud_google_com_v1beta1.SQLInstance:
		c := customClient.SqlV1beta1().SQLInstances(new.Namespace)
		return func() error {
			log.Infof("creating new *sql_cnrm_cloud_google_com_v1beta1.SQLInstance for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "sqlInstance", err)
			}
			return nil
		}

	case *sql_cnrm_cloud_google_com_v1beta1.SQLDatabase:
		c := customClient.SqlV1beta1().SQLDatabases(new.Namespace)
		return func() error {
			log.Infof("creating new *sql_cnrm_cloud_google_com_v1beta1.SQLDatabase for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "sqlDatabase", err)
			}
			return nil
		}

	case *sql_cnrm_cloud_google_com_v1beta1.SQLUser:
		c := customClient.SqlV1beta1().SQLUsers(new.Namespace)
		return func() error {
			log.Infof("creating new *sql_cnrm_cloud_google_com_v1beta1.SQLUser for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "sqlUser", err)
			}
			return nil
		}

	case *istio_security_v1beta1.AuthorizationPolicy:
		c := istioClient.SecurityV1beta1().AuthorizationPolicies(new.Namespace)
		return func() error {
			log.Infof("creating new *istio_security_v1beta1.AuthorizationPolicy for %s", new.Name)
			_, err := c.Create(new)
			if err != nil && !errors.IsAlreadyExists(err) {
				return fmt.Errorf("%s: %s", "authorizationPolicy", err)
			}
			return nil
		}

	default:
		panic(fmt.Errorf("BUG! You didn't specify a case for type '%T' in the file hack/generator/updater.go", new))
	}
}

func FindAll(clientSet kubernetes.Interface, customClient clientV1Alpha1.Interface, istioClient istioClientSet.Interface, app *nais.Application) ([]runtime.Object, error) {
	resources := make([]runtime.Object, 0)

	{
		c := clientSet.CoreV1().Services(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*corev1.Service", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*corev1.Service", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := clientSet.CoreV1().Secrets(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*corev1.Secret", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*corev1.Secret", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := clientSet.CoreV1().ServiceAccounts(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*corev1.ServiceAccount", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*corev1.ServiceAccount", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := clientSet.AppsV1().Deployments(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*appsv1.Deployment", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*appsv1.Deployment", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := clientSet.NetworkingV1beta1().Ingresses(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*networkingv1beta1.Ingress", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*networkingv1beta1.Ingress", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := clientSet.AutoscalingV1().HorizontalPodAutoscalers(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*autoscalingv1.HorizontalPodAutoscaler", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*autoscalingv1.HorizontalPodAutoscaler", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := clientSet.NetworkingV1().NetworkPolicies(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*networkingv1.NetworkPolicy", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*networkingv1.NetworkPolicy", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := customClient.NetworkingV1alpha3().VirtualServices(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*networking_istio_io_v1alpha3.VirtualService", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*networking_istio_io_v1alpha3.VirtualService", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := customClient.NetworkingV1alpha3().ServiceEntries(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*networking_istio_io_v1alpha3.ServiceEntry", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*networking_istio_io_v1alpha3.ServiceEntry", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := clientSet.RbacV1().Roles(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*rbacv1.Role", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*rbacv1.Role", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := clientSet.RbacV1().RoleBindings(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*rbacv1.RoleBinding", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*rbacv1.RoleBinding", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := customClient.IamV1beta1().IAMServiceAccounts(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := customClient.IamV1beta1().IAMPolicies(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*iam_cnrm_cloud_google_com_v1beta1.IAMPolicy", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*iam_cnrm_cloud_google_com_v1beta1.IAMPolicy", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := customClient.IamV1beta1().IAMPolicyMembers(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := customClient.StorageV1beta1().StorageBuckets(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*storage_cnrm_cloud_google_com_v1beta1.StorageBucket", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*storage_cnrm_cloud_google_com_v1beta1.StorageBucket", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := customClient.StorageV1beta1().StorageBucketAccessControls(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := customClient.SqlV1beta1().SQLInstances(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*sql_cnrm_cloud_google_com_v1beta1.SQLInstance", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*sql_cnrm_cloud_google_com_v1beta1.SQLInstance", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := customClient.SqlV1beta1().SQLDatabases(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*sql_cnrm_cloud_google_com_v1beta1.SQLDatabase", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*sql_cnrm_cloud_google_com_v1beta1.SQLDatabase", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := customClient.SqlV1beta1().SQLUsers(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*sql_cnrm_cloud_google_com_v1beta1.SQLUser", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*sql_cnrm_cloud_google_com_v1beta1.SQLUser", err)
			}
			resources = append(resources, items...)
		}
	}

	{
		c := istioClient.SecurityV1beta1().AuthorizationPolicies(app.Namespace)
		existing, err := c.List(metav1.ListOptions{LabelSelector: "app=" + app.Name})
		if err != nil && !errors.IsNotFound(err) {
			return nil, fmt.Errorf("discover %s: %s", "*istio_security_v1beta1.AuthorizationPolicy", err)
		} else if existing != nil {
			items, err := meta.ExtractList(existing)
			if err != nil {
				return nil, fmt.Errorf("extract list of %s: %s", "*istio_security_v1beta1.AuthorizationPolicy", err)
			}
			resources = append(resources, items...)
		}
	}

	return withOwnerReference(app, resources), nil
}

func withOwnerReference(app *nais.Application, resources []runtime.Object) []runtime.Object {
	owned := make([]runtime.Object, 0, len(resources))

	hasOwnerReference := func(r runtime.Object) (bool, error) {
		m, err := meta.Accessor(r)
		if err != nil {
			return false, err
		}
		for _, ref := range m.GetOwnerReferences() {
			if ref.UID == app.UID {
				return true, nil
			}
		}
		return false, nil
	}

	for _, resource := range resources {
		ok, err := hasOwnerReference(resource)
		if err == nil && ok {
			owned = append(owned, resource)
		}
	}

	return owned
}

func DeleteIfExists(clientSet kubernetes.Interface, customClient clientV1Alpha1.Interface, istioClient istioClientSet.Interface, resource runtime.Object) func() error {
	switch new := resource.(type) {

	case *corev1.Service:
		c := clientSet.CoreV1().Services(new.Namespace)
		return func() error {
			log.Infof("deleting *corev1.Service for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "service", err)
			}

			return err
		}

	case *corev1.Secret:
		c := clientSet.CoreV1().Secrets(new.Namespace)
		return func() error {
			log.Infof("deleting *corev1.Secret for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "secret", err)
			}

			return err
		}

	case *corev1.ServiceAccount:
		c := clientSet.CoreV1().ServiceAccounts(new.Namespace)
		return func() error {
			log.Infof("deleting *corev1.ServiceAccount for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "serviceAccount", err)
			}

			return err
		}

	case *appsv1.Deployment:
		c := clientSet.AppsV1().Deployments(new.Namespace)
		return func() error {
			log.Infof("deleting *appsv1.Deployment for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "deployment", err)
			}

			return err
		}

	case *networkingv1beta1.Ingress:
		c := clientSet.NetworkingV1beta1().Ingresses(new.Namespace)
		return func() error {
			log.Infof("deleting *networkingv1beta1.Ingress for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "ingress", err)
			}

			return err
		}

	case *autoscalingv1.HorizontalPodAutoscaler:
		c := clientSet.AutoscalingV1().HorizontalPodAutoscalers(new.Namespace)
		return func() error {
			log.Infof("deleting *autoscalingv1.HorizontalPodAutoscaler for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "horizontalPodAutoscaler", err)
			}

			return err
		}

	case *networkingv1.NetworkPolicy:
		c := clientSet.NetworkingV1().NetworkPolicies(new.Namespace)
		return func() error {
			log.Infof("deleting *networkingv1.NetworkPolicy for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "networkPolicy", err)
			}

			return err
		}

	case *networking_istio_io_v1alpha3.VirtualService:
		c := customClient.NetworkingV1alpha3().VirtualServices(new.Namespace)
		return func() error {
			log.Infof("deleting *networking_istio_io_v1alpha3.VirtualService for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "virtualService", err)
			}

			return err
		}

	case *networking_istio_io_v1alpha3.ServiceEntry:
		c := customClient.NetworkingV1alpha3().ServiceEntries(new.Namespace)
		return func() error {
			log.Infof("deleting *networking_istio_io_v1alpha3.ServiceEntry for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "ServiceEntry", err)
			}

			return err
		}

	case *rbacv1.Role:
		c := clientSet.RbacV1().Roles(new.Namespace)
		return func() error {
			log.Infof("deleting *rbacv1.Role for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "Role", err)
			}

			return err
		}

	case *rbacv1.RoleBinding:
		c := clientSet.RbacV1().RoleBindings(new.Namespace)
		return func() error {
			log.Infof("deleting *rbacv1.RoleBinding for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "RoleBinding", err)
			}

			return err
		}

	case *iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount:
		c := customClient.IamV1beta1().IAMServiceAccounts(new.Namespace)
		return func() error {
			log.Infof("deleting *iam_cnrm_cloud_google_com_v1beta1.IAMServiceAccount for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "iamServiceAccount", err)
			}

			return err
		}

	case *iam_cnrm_cloud_google_com_v1beta1.IAMPolicy:
		c := customClient.IamV1beta1().IAMPolicies(new.Namespace)
		return func() error {
			log.Infof("deleting *iam_cnrm_cloud_google_com_v1beta1.IAMPolicy for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "iamPolicy", err)
			}

			return err
		}

	case *iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember:
		c := customClient.IamV1beta1().IAMPolicyMembers(new.Namespace)
		return func() error {
			log.Infof("deleting *iam_cnrm_cloud_google_com_v1beta1.IAMPolicyMember for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "iamPolicyMember", err)
			}

			return err
		}

	case *storage_cnrm_cloud_google_com_v1beta1.StorageBucket:
		c := customClient.StorageV1beta1().StorageBuckets(new.Namespace)
		return func() error {
			log.Infof("deleting *storage_cnrm_cloud_google_com_v1beta1.StorageBucket for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "googleStorageBucket", err)
			}

			return err
		}

	case *storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl:
		c := customClient.StorageV1beta1().StorageBucketAccessControls(new.Namespace)
		return func() error {
			log.Infof("deleting *storage_cnrm_cloud_google_com_v1beta1.StorageBucketAccessControl for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "googleStorageBucketAccessControl", err)
			}

			return err
		}

	case *sql_cnrm_cloud_google_com_v1beta1.SQLInstance:
		c := customClient.SqlV1beta1().SQLInstances(new.Namespace)
		return func() error {
			log.Infof("deleting *sql_cnrm_cloud_google_com_v1beta1.SQLInstance for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "sqlInstance", err)
			}

			return err
		}

	case *sql_cnrm_cloud_google_com_v1beta1.SQLDatabase:
		c := customClient.SqlV1beta1().SQLDatabases(new.Namespace)
		return func() error {
			log.Infof("deleting *sql_cnrm_cloud_google_com_v1beta1.SQLDatabase for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "sqlDatabase", err)
			}

			return err
		}

	case *sql_cnrm_cloud_google_com_v1beta1.SQLUser:
		c := customClient.SqlV1beta1().SQLUsers(new.Namespace)
		return func() error {
			log.Infof("deleting *sql_cnrm_cloud_google_com_v1beta1.SQLUser for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "sqlUser", err)
			}

			return err
		}

	case *istio_security_v1beta1.AuthorizationPolicy:
		c := istioClient.SecurityV1beta1().AuthorizationPolicies(new.Namespace)
		return func() error {
			log.Infof("deleting *istio_security_v1beta1.AuthorizationPolicy for %s", new.Name)
			err := c.Delete(new.Name, &metav1.DeleteOptions{})
			if err != nil {
				if errors.IsNotFound(err) {
					return nil
				}
				return fmt.Errorf("%s: %s", "authorizationPolicy", err)
			}

			return err
		}

	default:
		panic(fmt.Errorf("BUG! You didn't specify a case for type '%T' in the file hack/generator/updater.go", new))
	}
}
